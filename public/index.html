<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>T-ele Santhai | Home</title>
  <link rel="stylesheet" href="/css/styles.css" />
</head>
<body>
  <header>
    <nav>
      <a href="/index.html">Home</a>
      <a href="/login.html">Login</a>
      <a href="/signup.html">Signup</a>
      <a href="/seller.html">Seller Dashboard</a>
    </nav>
  </header>

  <main class="container">
    <div class="card">
      <h2>Browse Products</h2>
      <div class="row">
        <input id="search" placeholder="Search by product name" />
        <input id="category" placeholder="Category (e.g. Electronics)" />
      </div>
      <button id="searchBtn">Search</button>
    </div>

    <div id="productGrid" class="grid"></div>
  </main>

  <script src="/js/api.js"></script>
  <script>
    const grid = document.getElementById('productGrid');

    async function loadProducts() {
      const search = document.getElementById('search').value;
      const category = document.getElementById('category').value;
      const params = new URLSearchParams({ search, category });

      try {
        const data = await apiFetch(`/products?${params.toString()}`);
        grid.innerHTML = data.products.map((p) => `
          <div class="card">
            <img class="product-image" src="${p.images?.[0] || 'https://via.placeholder.com/400x250'}" alt="${p.name}">
            <h3>${p.name}</h3>
            <p><strong>â‚¹${p.price}</strong></p>
            <p>${p.category}</p>
            <a href="/product.html?id=${p._id}">View details</a>
          </div>
        `).join('');
      } catch (error) {
        grid.innerHTML = `<p>${error.message}</p>`;
      }
    }

    document.getElementById('searchBtn').addEventListener('click', loadProducts);
    loadProducts();
  </script>
</body>
</html>
